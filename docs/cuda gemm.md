以cuda sample作为基础将代码提取出来